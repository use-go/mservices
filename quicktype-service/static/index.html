<!DOCTYPE html>
<html>

<head>
    <title>quicktype</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="zh-CN" />
    <meta name="Author" content="网页作者" />
    <meta name="Copyright" content="网站版权" />
    <meta name="keywords" content="网站关键字" />
    <meta name="description" content="网站描述" />
    <script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <style>
    .row {
        display:flex;
        width: 100%;
        flex-direction: row;
        flex-wrap: nowrap;
        justify-content: center;
        align-content: stretch;
        align-items: stretch;
    }
    .item {
        padding: 5px;
    }
    .left {
        width: 15%;
        order: 1;
        align-self: auto;
        flex-basis: auto;
        flex-grow: 0;
        flex-shrink: 1;
        background: #fff;
    }
    .left ul {
        border-radius: 5px;
        padding-inline-start: 0px;
        height:calc(100vh - 31px);
        overflow: scroll;
        color: #555;
        margin: 0px;
        margin-left: 5px;
    }
    .right {
        width: 85%;
        order: 1;
        align-self: auto;
        flex-basis: auto;
        flex-grow: 0;
        flex-shrink: 1;
        padding: 5px;
        background: #f6f6f6;
    }
    .left ul>li {
        list-style:none;
        padding: 4px;
    }
    .left ul>li:hover{
        cursor:pointer;
        background:#eee !important;
    }
    .act{
        cursor:pointer;
    }
    .act-nav {
        width: 100%;
        height: 32px;
        line-height:32px;
        font-size: 14px;
        color: #777;
    }
    .act-bar{
        display:flex;
        width: 100%;
        height: 32px;
        line-height:32px;
        flex-direction: row;
        flex-wrap: nowrap;
        justify-content: flex-start;
        align-content: stretch;
        align-items: stretch;
        background: #f6f6f6;
        font-size: 14px;
        color: #555;
    }
    .act-1 {
        height: 32px;
        order: 1;
        align-self: auto;
        flex-basis: auto;
        flex-grow: 0;
        flex-shrink: 1;
        border-radius: 4px;
        background: #e0e0e0;
        padding-left: 6px;
        padding-right: 6px;
    }
    .act-2 {
        order: 1;
        align-self: auto;
        flex-basis: auto;
        flex-grow: 0;
        flex-shrink: 1;
        margin-left: 4px;
        border-radius: 4px;
        background: #e0e0e0;
        padding-left: 6px;
        padding-right: 6px;
    }
    .act-3 {
        order: 1;
        align-self: auto;
        flex-basis: auto;
        flex-grow: 0;
        flex-shrink: 1;
        margin-left: 4px;
        border-radius: 4px;
        background: #e0e0e0;
        padding-left: 6px;
        padding-right: 6px;
    }
    .act-4 {
        order: 1;
        align-self: auto;
        flex-basis: auto;
        flex-grow: 0;
        flex-shrink: 1;
        margin-left: 4px;
        border-radius: 4px;
        background: #e0e0e0;
        padding-left: 6px;
        padding-right: 6px;
    }
    .act-5 {
        order: 1;
        align-self: auto;
        flex-basis: auto;
        flex-grow: 0;
        flex-shrink: 1;
        margin-left: 4px;
        border-radius: 4px;
        padding-left: 6px;
        padding-right: 6px;
        padding-top: 5px;
    }
    .code {
        background-color:#333;
        color:#fff;
        padding: 10px;
        font-size: 12px;
        margin-top:5px;
        height:calc(100vh - 64px - 51px);
        overflow: scroll;
    }
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }
    ::-webkit-scrollbar-thumb {
        border-radius: 5px;
        background: #ccc;
    }
    ::-webkit-scrollbar-track {
        border-radius: 0px;
        background: #fff;
    }
    </style>
</head>

<body style="background: #f0f2f5;">
    <div class="container" id="app">
        <div class="row">
            <div class="item left">
                <ul>
                    <li v-for="tb in tables" v-on:click="table2proto(tb)">
                        {{ tb }}
                    </li>
                </ul>
            </div>
            <div class="item right">
                <div class="act-nav">{{ db }}/{{ table }}</div>
                <div class="act-bar">
                    <div class="act act-1" v-on:click="table2proto(table)">Proto</div>
                    <div class="act act-2" v-on:click="table2go(table)">Struct</div>
                    <div class="act act-3" v-on:click="table2handler(table)">Handler</div>
                    <div class="act act-4" v-on:click="table2rw(table)">Read/Write</div>
                    <div class="act act-4" v-on:click="table2db(table)">DB</div>
                    <div class="act act-5" v-on:click="copyToClipboard(code)">
                        <svg t="1643340468837" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1676" width="23" height="23"><path d="M568.7 319.8l86.8 86.8v476.6h-466V319.8h379.2m29-70H178.9c-32.8 0-59.4 26.5-59.4 59.3v584.7c0 15.7 6.3 30.8 17.4 42 11.1 11.2 26.2 17.4 42 17.4h487.4c15.7 0 30.8-6.3 41.9-17.4 11.1-11.1 17.3-26.2 17.3-42V377.6L597.7 249.8z" fill="#707070" p-id="1677"></path><path d="M776.7 70.8H357.9c-32.8 0-59.4 26.5-59.4 59.3v100h70v-89.3h379.2l86.8 86.8v476.6h-85.8v70h96.6c15.7 0 30.8-6.3 41.9-17.4 11.1-11.1 17.3-26.2 17.3-42V198.6L776.7 70.8z" fill="#707070" p-id="1678"></path></svg>
                    </div>
                </div>
                <div class="code" v-html="code" style="white-space: pre-wrap;"></div>
            </div>
        </div>
    </div>
</body>
<script>
    new Vue({
        el: '#app',
        data: {
            dns: "root:gmt@tcp(192.168.202.128:3306)/yearning?charset=utf8mb4&parseTime=True&loc=Local",
            tables: [],
            table: '',
            db: 'yearning',
            code: ''
        },
        mounted () {
            axios
            .get('/quicktype/type/tables?dsn=root%3Agmt%40tcp(192.168.202.128%3A3306)%2Fyearning%3Fcharset%3Dutf8mb4%26parseTime%3DTrue%26loc%3DLocal')
            .then(response => response.data)
            .then(res => {
                this.tables = res.data
                this.table2proto(this.tables[0])
                this.table = this.tables[0]
            })
        },
        methods: {
            copyToClipboard: function(s) {
                if (window.clipboardData) {
                    window.clipboardData.setData('text', s);
                } else {
                    (function(s) {
                        document.oncopy = function(e) {
                            e.clipboardData.setData('text', s);
                            e.preventDefault();
                            document.oncopy = null;
                        }
                    })(s);
                    document.execCommand('Copy');
                }
                this.showToast("Copy success", 1000)
            },
            table2go: function (tb) {
                axios
                .get('/quicktype/type/table2go?table=' + tb + '&dsn=root%3Agmt%40tcp(192.168.202.128%3A3306)%2Fyearning%3Fcharset%3Dutf8mb4%26parseTime%3DTrue%26loc%3DLocal')
                .then(response => response.data)
                .then(res => {
                    this.code = res.data
                })
            },
            table2proto: function (tb) {
                axios
                .get('/quicktype/type/table2proto?table=' + tb + '&dsn=root%3Agmt%40tcp(192.168.202.128%3A3306)%2Fyearning%3Fcharset%3Dutf8mb4%26parseTime%3DTrue%26loc%3DLocal')
                .then(response => response.data)
                .then(res => {
                    this.code = res.data
                    this.table = tb
                })
            },
            table2handler: function (tb) {
                axios
                .get('/quicktype/type/table2handler?table=' + tb + '&dsn=root%3Agmt%40tcp(192.168.202.128%3A3306)%2Fyearning%3Fcharset%3Dutf8mb4%26parseTime%3DTrue%26loc%3DLocal')
                .then(response => response.data)
                .then(res => {
                    this.code = res.data
                })
            },
            table2rw: function (tb) {
                axios
                .get('/quicktype/type/table2rw?table=' + tb + '&dsn=root%3Agmt%40tcp(192.168.202.128%3A3306)%2Fyearning%3Fcharset%3Dutf8mb4%26parseTime%3DTrue%26loc%3DLocal')
                .then(response => response.data)
                .then(res => {
                    this.code = res.data
                })
            },
            table2db: function (tb) {
                axios
                .get('/quicktype/type/table2db?table=' + tb + '&dsn=root%3Agmt%40tcp(192.168.202.128%3A3306)%2Fyearning%3Fcharset%3Dutf8mb4%26parseTime%3DTrue%26loc%3DLocal')
                .then(response => response.data)
                .then(res => {
                    this.code = res.data
                })
            },
            showToast(msg,duration){  
                duration=isNaN(duration)?3000:duration;  
                var m = document.createElement('div');  
                m.innerHTML = msg;  
                m.style.cssText="width:10%; min-width:50px; background:#fff; opacity:0.6; height:auto;min-height: 35px; color:#333; line-height:35px; text-align:center; border-radius:4px; position:fixed; top:40%; left:45%; z-index:999999;";  
                document.body.appendChild(m);  
                setTimeout(function() {  
                    var d = 0.5;  
                    m.style.webkitTransition = '-webkit-transform ' + d + 's ease-in, opacity ' + d + 's ease-in';  
                    m.style.opacity = '0';  
                    setTimeout(function() { document.body.removeChild(m) }, d * 1000);  
                }, duration);  
            }
        }
    })
</script>
</html>